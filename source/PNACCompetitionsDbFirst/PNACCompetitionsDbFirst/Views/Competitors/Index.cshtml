@using PNACCompetitionsDbFirst.Entities;
@using PNACCompetitionsDbFirst.Entities.ViewModels;
@model CompetitorIndex

@{
  ViewBag.Title = "Competitors";
}

<script>

  function DeleteCompetitor(id) {
    if (confirm('Are you sure you want to delete this competitor?')) {

      $.ajax("/Competitors/Delete?id=" + id)

        .done(function (msg) {

          if (msg.success == 'true')
          {
            $('#row-' + id).hide('slow');
          }

        })
        .fail(function () {
          alert("DeleteCompetitor error");
        })

    }

    return false;
  }

</script>

<div class="row">
  <div class="col-md-4">
    <h2>Competitors</h2>
  </div>
</div>

<div class="row">
  <div class="col-md-4">
    <div class="table-responsive">

      @if (Model.CanCreate)
      {
        @Html.ActionLink("New", "New", "Competitors", new { }, new { @class = "btn btn-primary btn-sm" })
      }

      <table class="table table-striped">
        <thead>
          <tr>
            @if (Model.CompetitorListItems.Any(c => c.CanEdit))
            {
              <th>Action</th>
            }
            <th>Name</th>
          </tr>
        </thead>
        <tbody>


          @foreach (CompetitorListItem competitor in Model.CompetitorListItems)
          {
            <tr id="row-@competitor.CompetitorId">

              @if (Model.CompetitorListItems.Any(c => c.CanEdit))
              {
                <td class="table-action">
                  @if (competitor.CanEdit)
                  {
                    @Html.ActionLink("Edit", "Edit", "Competitors", new { id = competitor.CompetitorId }, new { @class = "btn btn-primary btn-sm" })
                    @Html.ActionLink("Delete", "Delete", "Competitors", new { id = competitor.CompetitorId }, new { @class = "btn btn-primary btn-sm", onclick = "return DeleteCompetitor(" + competitor.CompetitorId + ")" })
                  }
                </td>
              }

              <td>@competitor.Name
              
              @if(competitor.Hide)
              {
                @:(hidden)
              }

              </td>
            </tr>
          }

        </tbody>
      </table>
    </div>
  </div>
</div>
